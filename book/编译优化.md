![image-20210512142002870](/Users/zhong/Library/Application Support/typora-user-images/image-20210512142002870.png)

```javascript
// vue.config.js
const SpeedMeasurePlugin = require('speed-measure-webpack-plugin')
const hardSourcePlugin = require('hard-source-webpack-plugin')

module.exports = {
  chainWebpack:config=>{
    //...
    config.plugin('SpeedMeasurePlugin').use(new SpeedMeasurePlugin({
      outputFormat: 'human'
    }))
    //...
    // 构建时进行缓存 二次构建更快
    config.plugin('HardSourceWebpackPlugin').use(new hardSourcePlugin())
  }
}
```



OTB拆分打包

![image-20210512174006112](/Users/zhong/Library/Application Support/typora-user-images/image-20210512174006112.png)





项目整体已做的优化

1. `productionSourceMap:false`  关闭生产sourcemap

2. cdn加载部分内容

   ```json
   config.externals({
         vue: 'Vue',
         'vue-router': 'VueRouter',
         vuex: 'Vuex',
         axios: 'axios',
         'element-ui': 'ELEMENT',
         echarts: 'echarts'
       })
   ```

3. 开启`gzip`压缩

   ```json
   config.plugin('compressionPlugin').use(
           new CompressionWebpackPlugin({
             test: /\.js$|\.html$|\.css$/,
             threshold: 4096
           })
         )
   ```

4. 大文件单独chunk

   ```json
   config.optimization.splitChunks({
         chunks: 'all',
         cacheGroups: {
           xlsx: {
             name: 'chunk-xlsx',
             // test: /[\\/]node_modules[\\/](xlsx\.js)/,
             test: /[\\/]node_modules[\\/]_?xlsx(.*)/,
             priority: 10
           }
         }
       })
   ```

5. 异步组件

   ```javascript
   return import(`../${component}.vue`)
   ```



提升幅度巨大 从60s 降低到了3.8s





![image-20210514105529806](/Users/zhong/Library/Application Support/typora-user-images/image-20210514105529806.png)

在node_modules 中的bnjs 怎么办

重装一下依赖

![image-20210514113140575](/Users/zhong/Library/Application Support/typora-user-images/image-20210514113140575.png)