# 每日总结

### 2020-12-7 星期一

> 元素宽度自适应、代码片段

今天优化了浪漫春天的中台首页，稍微紧凑一些，调整元素的时候发现元素会继承父元素的宽度，因为需要用到自适应，给当前元素加上  `position:absolute;` 就能阻止继承宽度，转变为自适应，目前还没发现有什么副作用。转战正式版，弹框在业务需求中经常有，于是抽离出代码片段，下次再写弹框就直接使用，不用再去想着写组件通讯，节约时间。

### 2020-12-8 星期二

> TypeScript、Object

早上尝试为正式版加入TypeScript，结果运行起来不是很理想，加上个人对TS了解也比较浅，最后还是默默的退回。退回的时候代码都回退到昨天提交的版本，结果运行起来报错，想了下删掉了`node_modules` 这个文件夹，再运行下`npm i `，再次运行就ok了。修复下浪漫春天主题折扣分类折扣里面发给后端的参数有问题。然后又回到正式版，整个人写得有点晕，尺码分组需要将新增和修改的弹框调整下，又是这样的重复业务，其实应该可以抽出一个代码片段，专门处理这种新增/修改弹框，解决掉通讯问题可以节约很多时间。今天就是在通讯的时候花了很多时间，共用组件有一个很大的问题就是，弹框关闭就要清空数据，是不是应该做一个数据缓存。把列的内容写成JSX，但是发现有些东西没办法实现，比如双向绑定，会出现对象丢失的情况。就是输入无法改变input值，改成slot的写法后，发现如果清空了from对象，里面没有属性也会导致绑定不上。没有深入去试验，不过我感觉问题应该出在数据地址指向的问题，跟丢了。还是要多抽离出一些代码片段，抓紧copy，才能有更多时间学习。

### 2020-12-9 星期三

> width、initial

今天真正成为了CV仔，一直在搬运各种页面，写得真的烦躁。有个问题困扰蛮久的，就是`el-select`为什么在`el-from`里面有时候就不能自动增加高度了，后来找了半天，发现是设置了`size`的原因，如果不是设置`size:medium`或者不是使用默认值，都会将`el-select`变成固定高度。然后我就在想这个东西是怎么实现的自动高度，毕竟我设置了`heigth:100% !important`都不行，只有调试的时候关掉`input`上的内联样式 才有起作用。然后就在想怎样能清除掉设置过的`style`查了下[MDN](https://developer.mozilla.org/zh-CN/docs/Web/CSS/Common_CSS_Questions)，发现`initial`这个值，不过我设置了也没啥用，毕竟`100%`也是继承父元素 。不懂嘛，那就看源码好了，下去看`elment`的源码，找到了`resetInputHeight`这个方法，里面一看，其实也不困难。`input`与`tag`其实是两个`div`构建的，如果超过行了，就将`tag`的高度设置给`input`即可，确实是挺巧妙的。不过业务还有个需求，就是能不能横向动态扩展，我想了下其实也是可以，我们知道一行的高度，那就拿到`tag`实际的高度/行高，就能知道换行，我们还可以得到`tag`的宽度，只要元素一换行就增加宽度即可实现横向动态扩展。不过这里面还有很多细节，之后再进行完善。完了我还尝试了`    position: absolute`的副作用，oh，这就很明显了，用了这个相当于脱离常规文档流（我把这个事给忘了），后面的元素会往前面挤，而当前这个元素则是浮着，这就很诡异。我再去查看（网友论述，MDN助力），发现`width`其实还有个属性专门解决这个问题，`width:min-content`，当然不止这个属性，还有[其他几个](https://developer.mozilla.org/zh-CN/docs/Web/CSS/width)。其他的话暂时没有大的发现，无奈要写各种重复的业务，抽到没东西抽了。

### 2020-12-10 星期四

>focus、filters、css-var

今天尝试为导航增加失焦自动隐藏，一开始无法触发，[查询](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Global_attributes/tabindex)得知`div`不能直接触发，需要增加`tabindex="0"`的属性。不过虽然加上后有效果了，但是点击`div`里面的元素会失焦，导致哪怕是在热区也会触发隐藏。由于时间关系没有深究，明天可以看下如何让子元素的聚焦冒泡上去。写Vue的业务代码也快半年了，今天终于是用上了，真是太香了，很可惜听说Vue3中被删除了。还遇到一个需求，需要知道当前数组是否存在重复，万能的百度，英语差的人就是这样看中文比较亲切点。可以将一个数据去重，然后再对比前后长度即可知道这个数组有没有重复项。

```javascript
let arr = [1,2,2,3,4,2,6];
let newArr = [...new Set(arr)];
if(arr.length !== newArr.length) return false;
```

今天还看到一篇很有意思的[文章](https://mp.weixin.qq.com/s/MjzeeFr7pglIRzcZ27xwgQ)，感觉一下子就悟了，JS仅需要传递当前点击的位置信息到CSS变量中，即可实现很多有意思的效果，值得研究下（CSS变量是真的很好用）

顺便复习下，`mouseenter mouseleave `仅作用在当前元素 ，`mouseover mouseout`不仅作用在当前元素，还会作用在子元素

### 2020-12-11 星期五

> 拆解需求

今天写结构模版，对了新建模版和最外面的列表展示，下周要对编辑、复制、导入、删除，估计周一就能完成，总算是知道复制过来的代码是怎么运行的，早上真的看得晕乎乎。今天没有什么特别的发现，都是用老方法写业务。为什么面对这周的任务内心十分抗拒，我觉得最大的原因是因为任务多，工时少，代码不熟悉。即使是复制过来的代码，有些逻辑需要重写也是挺耗时间，最主要的原因还是没有理解到位需求的开始写。现在开始，要把需求理清楚，写下来然后再去执行，这样可以大大减少无力感。在一团很杂乱的代码中间要抽离出执行顺序真的是极差的体验，先抽离再执行，终究还是条理 不够清晰，需要加强这方面的提升。

### 2020-12-14 星期一

>计划行进

今天顺利完成了上个星期定下的计划，理顺的感觉真的很不错，只花了一个上午（还开了半个钟，迟到半个钟）的时间就基本完成了任务。一下子整个人都豁然开朗了，不过接下来的四天还有个任务需要完成，其实时间也很紧的，毕竟有三个弹框。今天还有个很搞笑的bug，发现是数据写多了一个`,`导致`step`直接报错，里面的值直接报`undefined`。明天主要是熟悉下整个系统的业务，毕竟做了半年还是不是很熟悉... 当然有平时业务太繁忙的原因，经常是做完这个立马接着下一个，明天应该能抽出点时间体验下这个系统。明早最重要的安排计划，一步一步来，不然等下又是混乱的一天，主要还是看后台写了多少接口。

### 2020-12-15 星期二

> 条理、数据初始化

计划明确后，确实做业务也专注多了，速度提升很明显，这样子就能有充裕的时间学习更多新知识。今天学到一个新东西，如何让Vue里面的data初始化，因为每次关闭弹框都需要清理数据，但是会经常忘记写。`Object.assign(this.$data,this.$option.data())` 但是这样会有个问题，请求回来的选项没了。

### 2020-12-16 星期三

>业务

今天依旧是对接口的一天，不过说实话，这个需求文档写的真的很一般，各种点都隐藏起来，每次快写完结果发现还有新的需求... 今天遇到的问题，`Array.reduce`对于空数组会报错，所以使用的时候还是要小心为妙，多考虑下边界就会少很多bug。我觉得那句话真的说得很对，永远不要相信后台传过来的数据。前端还是要老老实实做好边界考虑，如果没有做边界的话，其实可以用`try{}catch(){}`包一下会比较好点

### 2020-12-17 星期四

> 无

今天还是忙各种业务，实际上今天没有时间写总结，因为没带电脑回家，这条总结是周五和周六的临界点写的... 不过确实是忙着弄业务的事情，没有思考什么技术上的问题。

### 2020-12-18 星期五

>快速开发

总算是完成了青蛙王子的需求，真的是一言难尽，今天的业务代码更多是补充功能，都是写的旧代码，没有可以记录的知识点。下周清闲一点了，总算是可以学习点东西，这周还有处理两个烦心事，确实很压抑，不过已经找到解决方法了，准备去执行。今天的开发节奏掌握的还算不错，还是属于比较有条理的。现在写代码也不着急想着其他，先把当前的完成，再执行下一步。 今天补充了一些交互体验，有个问题，正则实现`12.13`比较困难，需要看下有什么好一点的正则，统一一下输入体验才行。今天还记录下一些代码片段，以后写代码会快很多，直接复制粘贴，重复的业务就让CV来拯救吧。还有一个很恶心的问题，在循环插槽中要如何实现计算属性，这个真的是蛮苦恼的，突然感觉JSX很爽。今天看了几篇文章，通过CSS实现用户追踪，这个方法的原理就是通过用户的操作触发CSS请求background，安插锚点。还有就是`Proxy、Reflect`，`Reflect`是内置对象，类似`Math`那种，而`Proxy`里面则是交给`Reflect`做处理。

### 2020-12-21 星期一

>优化

今天的做的事情不多，就是修复Bug和优化用户体验。然后还看了下Egg的文档，在对比Koa的介绍里，悟了点东西，为什么Koa叫做洋葱模型。原因是，请求和响应都会触发中间件，中间件就是一层洋葱，这样层层包裹住。

### 2020-12-22 星期二

> Egg.js

今天接手一个新项目，给图片打标签，调用的是AI公司的接口，技术栈目前暂定为（Node + Egg + MongoDB）。目前进度是先跑本地的测试用例，不过那个公司正在迁移服务，两个接口都跑不通，需要过几天再对接口。然后今天还尝试做动画优化，但是但是但是，有个人很让人头疼的点，表格的DOM节点太多了，只有`display:none`用起来是最顺畅的。目前还是没有找到比较好的办法，不过我现在想想，我应该可以固定下表格的宽度，现在表格用的自适应宽度。

### 2020-12-23 星期三

我淦了，今天真的是做得最累的一天，因为多一个空值的需求，整个功能都要重写。找了半天都没找到解决办法，真不如重写的快...MMP，今天就为了这事情头疼，也没写出什么玩意，真是浪费时间，明天早上重写完，研究下自动标签去了。









导航子元素聚焦冒泡

原来好像封装过一个👇

明天有个想法。封装一下el-input 下次使用数字的时候就不用那么麻烦了

两种选择 1、 直接去封装一个组件 2、使用指令

情况：1、仅输入数字 2、数字仅限两位小数 3、整数



